<?php include '../includes/header.php'; ?>

<!-- GALLERY PAGE HERO -->
<section class="relative bg-cover bg-center h-[40vh] md:h-[50vh]" style="background-image:url('../assets/images/news-hero.png');">
    <div class="absolute inset-0 bg-black bg-opacity-60"></div>
    <div class="relative z-10 max-w-7xl mx-auto px-4 md:px-6 h-full flex flex-col justify-center">
        <div class="text-white">
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4">ELECT Gallery</h1>
            <p class="text-lg md:text-xl max-w-2xl">Be part of our Journey through our Gallery of our energy-efficient lighting projects, installations, and activities.</p>
        </div>
    </div>
</section>

<!-- BREADCRUMB -->
<div class="bg-gray-100 py-4">
    <div class="max-w-7xl mx-auto px-4 md:px-6">
        <nav class="flex items-center space-x-2 text-sm">
            <a href="../index.php" class="text-blue-600 hover:text-blue-800">Home</a>
            <span class="text-gray-400">/</span>
            <span class="text-gray-600">Gallery</span>
        </nav>
    </div>
</div>

<!-- MAIN GALLERY CONTENT -->
<section class="py-8 md:py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 md:px-6">
        <!-- Page Header -->
        <div class="border-b-4 border-[#fdbf30] pb-6 mb-8 md:mb-12">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-900">Project Gallery</h2>
            <p class="text-gray-600 mt-2 text-sm md:text-base">Browse through our collection of images from various project activities.</p>
            
            <!-- Filter Tabs - Mobile responsive (exactly like news page) -->
            <div class="flex flex-wrap gap-2 mt-4 md:mt-6 text-center overflow-x-auto pb-2">
                <button class="gallery-filter-btn active whitespace-nowrap px-3 py-1.5 md:px-4 md:py-2 bg-[#247646] text-white rounded-lg font-medium transition-colors text-sm md:text-base" data-filter="all">
                    All Images
                </button>
                <button class="gallery-filter-btn whitespace-nowrap px-3 py-1.5 md:px-4 md:py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors text-sm md:text-base" data-filter="installations">
                    Installations
                </button>
                <button class="gallery-filter-btn whitespace-nowrap px-3 py-1.5 md:px-4 md:py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors text-sm md:text-base" data-filter="events">
                    Events
                </button>
                <button class="gallery-filter-btn whitespace-nowrap px-3 py-1.5 md:px-4 md:py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors text-sm md:text-base" data-filter="workshops">
                    Workshops
                </button>
                <button class="gallery-filter-btn whitespace-nowrap px-3 py-1.5 md:px-4 md:py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors text-sm md:text-base" data-filter="team">
                    Team
                </button>
                <button class="gallery-filter-btn whitespace-nowrap px-3 py-1.5 md:px-4 md:py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition-colors text-sm md:text-base" data-filter="before-after">
                    Before/After
                </button>
            </div>
        </div>
        
        <!-- Search (exactly like news page) -->
        <div class="mb-6 md:mb-8 px-4">
            <div class="relative w-full">
                <input type="text" id="searchGallery" placeholder="Search images..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#fdbf30] focus:border-transparent text-sm md:text-base">
                <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
            </div>
        </div>
        
        <!-- Gallery Grid -->
        <div id="galleryGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
            <!-- Gallery Item 1 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="installations" data-title="LED Installation at UNZA">
                <div class="relative w-full">
                    <img src="../assets/images/news1.jpg" alt="LED Installation at UNZA" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>March 15, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">LED Retrofit at Main Library</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        Successful installation of energy-efficient LED lighting at University of Zambia's main library.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 2 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="events" data-title="Project Launch Ceremony">
                <div class="relative w-full">
                    <img src="../assets/images/gallery-event-1.jpg" alt="Project Launch" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>March 10, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">Official Project Launch Event</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        Dignitaries and stakeholders gather for the official launch of the ELECT project.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 3 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="workshops" data-title="Technical Workshop">
                <div class="relative w-full">
                    <img src="../assets/images/news2.jpg" alt="Technical Workshop" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>March 5, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">Hands-on Technical Workshop</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        Participants learning about LED technology and installation techniques.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 4 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="installations" data-title="Classroom Lighting">
                <div class="relative w-full">
                    <img src="../assets/images/news3.jpg" alt="Classroom Lighting" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>February 28, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">Classroom Lighting Upgrade</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        Modern LED lighting installation in university classrooms for better energy efficiency.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 5 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="before-after" data-title="Lighting Comparison">
                <div class="relative w-full">
                    <img src="../assets/images/About.jpg" alt="Before and After Comparison" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>February 20, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">Before/After Comparison</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        Visual comparison showing the dramatic improvement in lighting quality after retrofit.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 6 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="team" data-title="Project Team">
                <div class="relative w-full">
                    <img src="../assets/images/lightbulb.jpeg" alt="Project Team" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>February 15, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">ELECT Project Team</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        The dedicated team behind the Energy Efficient Lighting project.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 7 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="workshops" data-title="Training Session">
                <div class="relative w-full">
                    <img src="../assets/images/news2.jpg" alt="Training Session" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>February 10, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">Practical Training Session</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        Hands-on training for university technical staff on LED maintenance.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 8 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="events" data-title="Site Visit">
                <div class="relative w-full">
                    <img src="../assets/images/news1.jpg" alt="Site Visit" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>February 5, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">EU Delegation Site Visit</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        European Union representatives visiting project implementation sites.
                    </p>
                </div>
                <!-- Fade line separator -->
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden"></div>
            </article>
            
            <!-- Gallery Item 9 -->
            <article class="gallery-item md:rounded overflow-hidden border border-gray-200" data-category="installations" data-title="Laboratory Lighting">
                <div class="relative w-full">
                    <img src="../assets/images/news3.jpg" alt="Laboratory Lighting" class="w-full h-48 md:h-48 object-cover gallery-image cursor-pointer">
                </div>
                <div class="p-4 md:p-6">
                    <div class="flex items-center text-xs md:text-sm text-gray-500 mb-3">
                        <i class="fas fa-calendar-alt mr-2"></i>
                        <span>January 30, 2024</span>
                    </div>
                    <h3 class="text-lg md:text-xl font-bold text-gray-900 mb-3">Science Laboratory Upgrade</h3>
                    <p class="text-gray-600 mb-4 text-sm md:text-base">
                        Specialized LED lighting installation in university science laboratories.
                    </p>
                </div>
                <div class="h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent w-full mt-4 md:hidden hidden"></div>
            </article>
        </div>
        
        <!-- Load More Button -->
        <div class="text-center mt-8 md:mt-12">
            <button id="loadMoreBtn" class="bg-[#247646] hover:bg-[#1e5f3a] text-white px-6 py-2.5 md:px-8 md:py-3 rounded font-semibold transition-colors duration-300 text-sm md:text-base">
                <i class="fas fa-plus mr-2"></i>
                Load More Images
            </button>
            <div id="loadingIndicator" class="hidden mt-4">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[#247646]"></div>
                <span class="ml-2 text-gray-600">Loading more images...</span>
            </div>
        </div>
        
        <!-- Pagination Info -->
        <div class="mt-8 text-center text-gray-600 text-sm md:text-base">
            Showing <span id="currentCount">9</span> of <span id="totalCount">24</span> images
        </div>
    </div>
</section>

<!-- Image Modal -->
<div id="imageModal" class="fixed inset-0 z-50 hidden bg-black/90">
    <div class="relative w-full h-full flex items-center justify-center">
        <button id="closeModal" class="absolute top-4 right-4 text-white text-3xl z-10 hover:text-[#fdbf30] transition-colors">
            <i class="fas fa-times"></i>
        </button>
        <button id="prevBtn" class="absolute left-4 text-white text-3xl z-10 hover:text-[#fdbf30] transition-colors">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button id="nextBtn" class="absolute right-4 text-white text-3xl z-10 hover:text-[#fdbf30] transition-colors">
            <i class="fas fa-chevron-right"></i>
        </button>
        
        <div class="max-w-4xl w-full mx-4">
            <div id="modalImageContainer" class="relative">
                <img id="modalImage" src="" alt="" class="w-full h-auto max-h-[80vh] object-contain">
            </div>
            <div class="mt-4 text-center text-white">
                <h3 id="modalTitle" class="text-xl font-bold"></h3>
                <p id="modalDate" class="text-gray-300 mt-2"></p>
            </div>
        </div>
    </div>
</div>

<?php include '../includes/footer.php'; ?>

<!-- JavaScript for Gallery Page -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Elements
    const filterBtns = document.querySelectorAll('.gallery-filter-btn');
    const galleryItems = document.querySelectorAll('.gallery-item');
    const searchInput = document.getElementById('searchGallery');
    const loadMoreBtn = document.getElementById('loadMoreBtn');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const currentCount = document.getElementById('currentCount');
    const totalCount = document.getElementById('totalCount');
    
    // Modal elements
    const imageModal = document.getElementById('imageModal');
    const closeModal = document.getElementById('closeModal');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const modalImage = document.getElementById('modalImage');
    const modalTitle = document.getElementById('modalTitle');
    const modalDate = document.getElementById('modalDate');
    
    // State
    let visibleItems = 9;
    let currentFilter = 'all';
    let currentSearch = '';
    let currentModalIndex = 0;
    let currentVisibleItems = [];
    
    // Filter functionality
    filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            filterBtns.forEach(b => {
                b.classList.remove('active', 'bg-[#247646]', 'text-white');
                b.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            this.classList.add('active', 'bg-[#247646]', 'text-white');
            this.classList.remove('bg-gray-200', 'text-gray-700');
            
            currentFilter = this.dataset.filter;
            filterAndDisplayGallery();
        });
    });
    
    // Search functionality
    searchInput.addEventListener('input', function() {
        currentSearch = this.value.toLowerCase().trim();
        filterAndDisplayGallery();
    });
    
    // Filter and display gallery
    function filterAndDisplayGallery() {
        let filteredItems = Array.from(galleryItems);
        
        // Apply filter
        if (currentFilter !== 'all') {
            filteredItems = filteredItems.filter(item => 
                item.dataset.category === currentFilter
            );
        }
        
        // Apply search
        if (currentSearch) {
            filteredItems = filteredItems.filter(item => {
                const title = item.querySelector('h3').textContent.toLowerCase();
                const description = item.querySelector('p').textContent.toLowerCase();
                return title.includes(currentSearch) || description.includes(currentSearch);
            });
        }
        
        // Store current visible items for modal navigation
        currentVisibleItems = filteredItems;
        
        // Hide all items first
        galleryItems.forEach(item => {
            item.style.display = 'none';
        });
        
        // Show filtered items (up to visibleItems count)
        filteredItems.slice(0, visibleItems).forEach(item => {
            item.style.display = 'block';
        });
        
        // Update counters
        currentCount.textContent = Math.min(visibleItems, filteredItems.length);
        totalCount.textContent = filteredItems.length;
        
        // Show/hide load more button
        loadMoreBtn.style.display = visibleItems < filteredItems.length ? 'block' : 'none';
    }
    
    // Load more functionality
    loadMoreBtn.addEventListener('click', function() {
        loadingIndicator.classList.remove('hidden');
        loadMoreBtn.style.display = 'none';
        
        // Simulate loading delay
        setTimeout(() => {
            visibleItems += 3;
            filterAndDisplayGallery();
            loadingIndicator.classList.add('hidden');
            
            // Smooth scroll to newly loaded items
            const lastItem = document.querySelector('.gallery-item[style="display: block;"]:last-child');
            if (lastItem) {
                lastItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }, 800);
    });
    
    // Image modal functionality
    document.querySelectorAll('.gallery-image, .view-image-btn').forEach((element, index) => {
        element.addEventListener('click', function() {
            const galleryItem = this.closest('.gallery-item');
            openImageModal(galleryItem);
        });
    });
    
    function openImageModal(item) {
        const imgSrc = item.querySelector('img').src;
        const title = item.querySelector('h3').textContent;
        const date = item.querySelector('.flex.items-center span').textContent;
        
        // Find the index of this item in current visible items
        currentModalIndex = currentVisibleItems.indexOf(item);
        
        // Update modal content
        modalImage.src = imgSrc;
        modalImage.alt = title;
        modalTitle.textContent = title;
        modalDate.textContent = date;
        
        // Show modal
        imageModal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }
    
    // Close modal
    closeModal.addEventListener('click', closeImageModal);
    imageModal.addEventListener('click', function(e) {
        if (e.target === imageModal) {
            closeImageModal();
        }
    });
    
    // Keyboard navigation for modal
    document.addEventListener('keydown', function(e) {
        if (imageModal.classList.contains('hidden')) return;
        
        if (e.key === 'Escape') {
            closeImageModal();
        } else if (e.key === 'ArrowLeft') {
            navigateModal(-1);
        } else if (e.key === 'ArrowRight') {
            navigateModal(1);
        }
    });
    
    // Previous/Next buttons
    prevBtn.addEventListener('click', () => navigateModal(-1));
    nextBtn.addEventListener('click', () => navigateModal(1));
    
    function navigateModal(direction) {
        if (currentVisibleItems.length === 0) return;
        
        currentModalIndex = (currentModalIndex + direction + currentVisibleItems.length) % currentVisibleItems.length;
        openImageModal(currentVisibleItems[currentModalIndex]);
    }
    
    function closeImageModal() {
        imageModal.classList.add('hidden');
        document.body.style.overflow = 'auto';
    }
    
    // Initialize
    filterAndDisplayGallery();
    
    // Add keyboard shortcut for search
    document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            searchInput.focus();
        }
    });
});
</script>